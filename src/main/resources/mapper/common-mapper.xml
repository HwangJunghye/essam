<?xml version="1.0" encoding="UTF-8"?>
<!-- mapper(sql문) 작성 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.essam.www.common.ICommonDao">
		<select id="getSearchList" resultType="classbean">
		SELECT *
		FROM (SELECT ROWNUM RN, C.*, M.MBNICKNAME, CATE1.CATE1NAME, CATE2.CATE2NAME
			  FROM (SELECT *
			        FROM CLASS
			        WHERE 1=1
			        <if test="cate1No!=0">
			  	    AND CATE1NO = #{cate1No}
			        </if>
			  		<if test="cate2No!=0">
			  		AND CATE2NO = #{cate2No}
			  		</if>
			  		<if test='keyword.equals("")'>
			  		AND CLSKEYWORD LIKE '%' || #{keyword} || '%'
			  		</if>
			  		ORDER BY CLSOPENDATE DESC
			  		) C
			 LEFT JOIN MEMBER M
			 ON C.MBID = M.MBID
			 LEFT JOIN CATE1
			 ON C.CATE1NO = CATE1.CATE1NO
			 LEFT JOIN CATE2
			 ON C.CATE2NO = CATE2.CATE2NO
			 )
		WHERE RN BETWEEN #{pageNo}*10-9 AND #{pageNo}*10
	</select>
</mapper>