<?xml version="1.0" encoding="UTF-8"?>
<!-- mapper(sql문) 작성 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.essam.www.etc.IEtcDao">
	
	<!-- 조회대상이 클래스 -->
	<select id="getClassStatistic" resultType="Map">
		<![CDATA[SELECT T1.*
     , SUM(DT_COUNT) OVER(ORDER BY CLSOPENDATE) AS total
  FROM (SELECT TO_CHAR(CLSOPENDATE, 'yyyymmdd') CLSOPENDATE 
             , COUNT(*) AS DT_COUNT
          FROM class
         WHERE CLSOPENDATE >= TO_DATE('20210501', 'yyyymmdd')
           AND CLSOPENDATE <  TO_DATE('20210511', 'yyyymmdd') + 1
         GROUP BY (TO_CHAR(CLSOPENDATE, 'yyyymmdd'))
        ) T1
 ORDER BY T1.CLSOPENDATE ASC]]>
	</select>
	
	<!-- 조회대상이 강사 -->
	<select id="getTeacherStatistic" resultType="Map">
		<![CDATA[SELECT T1.*
     , SUM(DT_COUNT) OVER(ORDER BY CLSOPENDATE) AS total
  FROM (SELECT TO_CHAR(CLSOPENDATE, 'yyyymmdd') CLSOPENDATE 
             , COUNT(*) AS DT_COUNT
          FROM class
         WHERE CLSOPENDATE >= TO_DATE('20210501', 'yyyymmdd')
           AND CLSOPENDATE <  TO_DATE('20210511', 'yyyymmdd') + 1
         GROUP BY (TO_CHAR(CLSOPENDATE, 'yyyymmdd'))
        ) T1
 ORDER BY T1.CLSOPENDATE ASC]]>
	</select>
	
	<!-- 조회대상이 학생 -->
	<select id="getStudentStatistic" resultType="Map">
		<![CDATA[SELECT T1.*
     , SUM(DT_COUNT) OVER(ORDER BY CLSOPENDATE) AS total
  FROM (SELECT TO_CHAR(CLSOPENDATE, 'yyyymmdd') CLSOPENDATE 
             , COUNT(*) AS DT_COUNT
          FROM class
         WHERE CLSOPENDATE >= TO_DATE('20210501', 'yyyymmdd')
           AND CLSOPENDATE <  TO_DATE('20210511', 'yyyymmdd') + 1
         GROUP BY (TO_CHAR(CLSOPENDATE, 'yyyymmdd'))
        ) T1
 ORDER BY T1.CLSOPENDATE ASC]]>
	</select>
	
</mapper>