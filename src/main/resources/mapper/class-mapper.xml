<?xml version="1.0" encoding="UTF-8"?>
<!-- mapper(sql문) 작성 -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.essam.www.eclass.IClassDao">

	
	<select id="getMyClassList" resultType="classbean">
		SELECT * FROM CLASS WHERE CLSNO=#{clsNo}
	</select>
	
	<select id="getStudentList" resultType="studentbean">
		SELECT * FROM V_STUDENTBEAN WHERE CLSNO=#{clsNo}
	</select>
	
	<select id="getStudentInfo" resultType="studentbean">
		SELECT * FROM V_STUDENTBEAN WHERE MBID=#{mbId} AND CLSNO=#{clsNo} 
	</select>
	
	<select id="getFileNo" resultType="classbean">
		SELECT FILENO FROM CLASS WHERE CLSNO=#{clsNo} AND ROWNUM=1
	</select>
	
	<insert id="classClassinfoInsert" parameterType="classbean" >
		<selectKey keyProperty="clsNo" resultType="String" order="BEFORE">
			SELECT TO_CHAR(CLASS_SEQ.NEXTVAL) FROM DUAL
		</selectKey>
	INSERT INTO CLASS(CLSNO, MBID, FILENO,CATE1NO,CATE2NO,CLSNAME, CLSOPENDATE, CLSLIMIT, CLSINTRO, CLSDESC, CLSPRICE, CLSKEYWORD,ZOOMLINK, ZOOMPWD)
	VALUES(#{clsNo}, #{mbId},#{fileNo},#{cate1No}, #{cate2No}, #{clsName},DEFAULT,#{clsLimit},#{clsIntro},#{clsDesc},#{clsPrice},#{clsKeyword}, #{zoomLink}, #{zoomPwd}	)
	</insert>
	
	<update id="classClassinfoUpdate" parameterType="classbean" >
		UPDATE CLASS SET 
			<if test="fileNo!=null">FILENO=#{fileNo},</if> CATE1NO=#{cate1No}, CATE2NO=#{cate2No}, CLSNAME=#{clsName},   
			CLSLIMIT=#{clsLimit}, CLSINTRO=#{clsIntro}, CLSDESC=#{clsDesc}, CLSPRICE=#{clsPrice}, CLSKEYWORD=#{clsKeyword}, 
			ZOOMLINK=#{zoomLink}, ZOOMPWD=#{zoomPwd}		
		WHERE CLSNO=#{clsNo}
	</update>
	
	
</mapper>